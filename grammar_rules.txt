CompilationUnit : ProgramUnit+ ;
ProgramUnit : DataDivision? ProcedureDivision? ProgramUnit* EndProgramStatement? ;
EndProgramStatement : END PROGRAM ProgramName DOT_FS ;
DataDivision : DATA DIVISION DOT_FS DataDivisionSection* ;
DataDivisionSection : WorkingStorageSection | LinkageSection | LocalStorageSection ;
WorkingStorageSection : WORKING_STORAGE SECTION DOT_FS DataDescriptionEntry* ;
LinkageSection : LINKAGE SECTION DOT_FS DataDescriptionEntry* ;
LocalStorageSection : LOCAL_STORAGE SECTION DOT_FS (LD LocalName DOT_FS)? DataDescriptionEntry* ;
DataDescriptionEntry : DataDescriptionEntryFormat1  ;
DataDescriptionEntryFormat1 : (INTEGERLITERAL | LEVEL_NUMBER_77) (FILLER | DataName)? (DataPictureClause | DataUsageClause | DataValueClause | DataSignClause )* DOT_FS ;
DataPictureClause : (PICTURE | PIC) IS? PictureString ;
PictureString : (PictureChars+ PictureCardinality?)+ ;
PictureChars : DOLLARCHAR | IDENTIFIER | NUMERICLITERAL | SLASHCHAR | COMMACHAR | DOT | COLONCHAR | ASTERISKCHAR | DOUBLEASTERISKCHAR | LPARENCHAR | RPARENCHAR | PLUSCHAR | MINUSCHAR | LESSTHANCHAR | MORETHANCHAR | integerLiteral ;
PictureCardinality : LPARENCHAR integerLiteral RPARENCHAR ;
DataRedefinesClause : REDEFINES DataName ;
DataRenamesClause : RENAMES QualifiedDataName ((THROUGH | THRU) QualifiedDataName)? ;
DataSignClause : (SIGN IS?)? (LEADING | TRAILING) (SEPARATE CHARACTER?)? ;
DataUsageClause : (USAGE IS?)? ( COMP | COMP_3 | COMP_4 | COMP_5 | COMPUTATIONAL | COMPUTATIONAL_3 | COMPUTATIONAL_4 | COMPUTATIONAL_5  | DISPLAY | DISPLAY_1 | PACKED_DECIMAL) ;
DataValueClause : (VALUE IS? | VALUES ARE?)? DataValueInterval (COMMACHAR? DataValueInterval)* ;
DataValueInterval : DataValueIntervalFrom DataValueIntervalTo? ;
DataValueIntervalFrom : literal | cobolWord ;
DataValueIntervalTo : (THROUGH | THRU) literal ;
ProcedureDivision : PROCEDURE DIVISION DOT_FS ProcedureDivisionBody ;
ProcedureDivisionBody : Paragraphs ProcedureSection* ;
ProcedureSection : procedureSectionHeader DOT_FS Paragraphs ;
Paragraphs : Sentence* Paragraph* ;
Paragraph : ParagraphName DOT_FS (Sentence*) ;
Sentence : Statement* DOT_FS ;
Statement : ComputeStatement | DisplayStatement | IfStatement | MoveStatement | StopStatement ;
ComputeStatement : COMPUTE ComputeStore+ (EQUALCHAR | EQUAL) ArithmeticExpression OnSizeErrorPhrase? NotOnSizeErrorPhrase? END_COMPUTE? ;
ComputeStore : Identifier ROUNDED? ;
DisplayStatement : DISPLAY DisplayOperand+ DisplayAt? DisplayUpon? DisplayWith? ;
DisplayOperand : Identifier | literal ;
DisplayAt : AT (Identifier | literal) ;
DisplayUpon : UPON (MnemonicName | EnvironmentName) ;
DisplayWith : WITH? NO ADVANCING ;
IfStatement : IF Condition IfThen IfElse? END_IF? ;
IfThen : THEN? (NEXT SENTENCE | Statement*) ;
IfElse : ELSE (NEXT SENTENCE | Statement*) ;
MoveStatement : MOVE ALL? (MoveToStatement | MoveCorrespondingToStatement) ;
MoveToStatement : MoveToSendingArea TO Identifier+ ;
MoveToSendingArea : Identifier | literal ;
MoveCorrespondingToStatement : (CORRESPONDING | CORR) MoveCorrespondingToSendingArea TO Identifier+ ;
MoveCorrespondingToSendingArea : Identifier ;
StopStatement : STOP (RUN | literal) ;
OnSizeErrorPhrase : ON? SIZE ERROR Statement* ;
NotOnSizeErrorPhrase : NOT ON? SIZE ERROR Statement* ;
ArithmeticExpression : MultDivs PlusMinus* ;
PlusMinus : (PLUSCHAR | MINUSCHAR) MultDivs ;
MultDivs : Powers MultDiv* ;
MultDiv : (ASTERISKCHAR | SLASHCHAR) Powers ;
Powers : (PLUSCHAR | MINUSCHAR)? Basis Power* ;
Power : DOUBLEASTERISKCHAR Basis ;
Basis : LPARENCHAR ArithmeticExpression RPARENCHAR | Identifier | literal ;
Condition : CombinableCondition AndOrCondition* ;
AndOrCondition : (AND | OR) (CombinableCondition | Abbreviation+) ;
CombinableCondition : NOT? SimpleCondition ;
SimpleCondition : LPARENCHAR Condition RPARENCHAR | RelationCondition ;
RelationCondition : RelationSignCondition | RelationArithmeticComparison | RelationCombinedComparison ;
RelationSignCondition : ArithmeticExpression IS? NOT? (POSITIVE | NEGATIVE | ZERO) ;
RelationArithmeticComparison : ArithmeticExpression RelationalOperator ArithmeticExpression ;
RelationCombinedComparison : ArithmeticExpression RelationalOperator LPARENCHAR RelationCombinedCondition RPARENCHAR ;
RelationCombinedCondition : ArithmeticExpression ((AND | OR) ArithmeticExpression)+ ;
RelationalOperator : (IS | ARE)? ( NOT? (GREATER THAN? | MORETHANCHAR | LESS THAN? | LESSTHANCHAR | EQUAL TO? | EQUALCHAR) | NOTEQUALCHAR | GREATER THAN? OR EQUAL TO? | MORETHANOREQUAL | LESS THAN? OR EQUAL TO? | LESSTHANOREQUAL ) ;
Abbreviation : NOT? RelationalOperator? ( ArithmeticExpression | LPARENCHAR ArithmeticExpression Abbreviation RPARENCHAR ) ;
Identifier : QualifiedDataName | TableCall | FunctionCall | specialRegister ;
TableCall : QualifiedDataName (LPARENCHAR Subscript (COMMACHAR? Subscript)* RPARENCHAR)* ReferenceModifier? ;
FunctionCall : FUNCTION FunctionName (LPARENCHAR Argument (COMMACHAR? Argument)* RPARENCHAR)* ReferenceModifier? ;
ReferenceModifier : LPARENCHAR CharacterPosition COLONCHAR Length? RPARENCHAR ;
CharacterPosition : ArithmeticExpression ;
Length : ArithmeticExpression ;
Subscript : ALL | integerLiteral | QualifiedDataName integerLiteral? | IndexName integerLiteral? | ArithmeticExpression ;
Argument : literal | Identifier | QualifiedDataName integerLiteral? | IndexName integerLiteral? | ArithmeticExpression ;
QualifiedDataName : QualifiedDataNameFormat1 | QualifiedDataNameFormat2 | QualifiedDataNameFormat3 | QualifiedDataNameFormat4 ;
QualifiedDataNameFormat1 : (DataName | ConditionName) (QualifiedInData+ InFile? | InFile)? ;
QualifiedDataNameFormat2 : ParagraphName InSection ;
QualifiedDataNameFormat3 : TextName InLibrary ;
QualifiedDataNameFormat4 : LINAGE_COUNTER InFile ;
QualifiedInData : InData | InTable ;
InData : (IN | OF) DataName ;
InFile : (IN | OF) FileName ;
InMnemonic : (IN | OF) MnemonicName ;
InSection : (IN | OF) SectionName ;
InLibrary : (IN | OF) LibraryName ;
InTable : (IN | OF) TableCall ;
Literal: NONNUMERICLITERAL | FigurativeConstant | NumericLiteral | BooleanLiteral
figurativeConstant: ALL literal | HIGH_VALUE | HIGH_VALUES | LOW_VALUE | LOW_VALUES | NULL_ | NULLS | QUOTE | QUOTES | SPACE | SPACES | ZERO | ZEROS | ZEROES;
BooleanLiteral: TRUE | FALSE;
ConditionName: CobolWord ;
DataName: CobolWord ;
